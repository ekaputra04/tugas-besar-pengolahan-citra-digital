<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Upload Gambar</title>
  </head>
  <body>
    <h1>Upload Dua Gambar</h1>
    <form
      action="/result"
      method="POST"
      enctype="multipart/form-data"
      id="image-upload-form"
    >
      <input
        type="file"
        name="file1"
        accept="image/*"
        id="file-input1"
        required
      /><br /><br />
      <input
        type="file"
        name="file2"
        accept="image/*"
        id="file-input2"
        required
      /><br /><br />
      <!-- Tambahkan elemen input untuk angka konstanta -->
      <div id="constant-input">
        <!-- <label for="constant-value"
          >Masukkan Nilai Konstanta (optional | default 0) :</label
        >
        <input
          type="number"
          id="constant-value"
          name="constant-value"
        /><br /><br /> -->
        <!-- <label for="alpha">Masukkan Nilai Alpha (optional | default 0) :</label>
        <input type="number" id="alpha" name="alpha" required /><br /><br />
        <label for="beta">Masukkan Nilai Beta (optional | default 0) :</label>
        <input type="number" id="beta" name="beta" required /><br /><br /> -->
        <label for="constant-value"
          >Masukkan Nilai Konstanta (optional | default 0) :</label
        >
        <input
          type="text"
          id="constant-value"
          name="constant-value"
          pattern="[0-9]+(\.[0-9]+)?"
          title="Masukkan angka atau angka bulat"
          required
        /><br /><br />
        <label for="alpha">Masukkan Nilai Alpha (optional | default 0) :</label>
        <input
          type="text"
          id="alpha"
          name="alpha"
          pattern="[0-9]+(\.[0-9]+)?"
          title="Masukkan angka atau angka desimal"
          required
        /><br /><br />
        <label for="beta">Masukkan Nilai Beta (optional | default 0) :</label>
        <input
          type="text"
          id="beta"
          name="beta"
          pattern="[0-9]+(\.[0-9]+)?"
          title="Masukkan angka atau angka desimal"
          required
        /><br /><br />
      </div>
      <input type="submit" value="Upload Gambar" />
    </form>

    <br />
    <img id="image1" src="" alt="Image 1" />
    <img id="image2" src="" alt="Image 2" />
    <br />

    <div id="image-processing-options" style="display: none">
      <h2>Pilihan Pengolahan Citra</h2>

      <button onclick="performOperation('addition')">
        Penjumlahan 2 Citra
      </button>
      <button onclick="performOperation('addition-constanta')">
        Penjumlahan Citra dengan Konstanta
      </button>
      <button onclick="performOperation('subtraction')">
        Pengurangan 2 Citra
      </button>
      <button onclick="performOperation('subtraction-constanta')">
        Pengurangan Citra dengan Konstanta
      </button>
      <button onclick="performOperation('multiplication')">
        Perkalian Citra
      </button>
      <button onclick="performOperation('img-blending')">Image Blending</button>
    </div>

    <script>
      // menampilkan gambar 1
      document
        .getElementById("file-input1")
        .addEventListener("change", function () {
          const fileInput = this;
          const image1 = document.getElementById("image1");

          const file = fileInput.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
              const imageDataUrl = e.target.result;
              image1.src = imageDataUrl;
            };
            reader.readAsDataURL(file);
          } else {
            image1.src = "";
          }
        });

      // menampilkan gambar 2
      document
        .getElementById("file-input2")
        .addEventListener("change", function () {
          const fileInput = this;
          const image2 = document.getElementById("image2");

          const file = fileInput.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
              const imageDataUrl = e.target.result;
              image2.src = imageDataUrl;
            };
            reader.readAsDataURL(file);
          } else {
            image2.src = "";
          }
        });

      function performOperation(operation) {
        // Mengirim jenis operasi ke server
        const form = document.getElementById("image-upload-form");
        const input = document.createElement("input");
        input.type = "hidden";
        input.name = "operation";
        input.value = operation;
        form.appendChild(input);
        // Memeriksa apakah operasi memerlukan input konstanta
        if (
          operation === "addition-constanta" ||
          operation === "subtraction-constanta"
        ) {
          // Menampilkan elemen input untuk konstanta
          document.getElementById("constant-input").style.display = "block";
        } else {
          // Sembunyikan elemen input untuk konstanta jika operasi lain dipilih
          document.getElementById("constant-input").style.display = "none";
        }
        form.submit();
      }

      document
        .getElementById("image-upload-form")
        .addEventListener("submit", function (event) {
          // Menghentikan pengiriman form bawaan agar kita dapat menampilkan pilihan operasi
          event.preventDefault();

          // Menampilkan tombol pilihan pengolahan citra
          document.getElementById("image-processing-options").style.display =
            "block";
        });
    </script>
  </body>
</html>
